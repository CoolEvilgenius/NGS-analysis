<a name="content">目录</a>

[基因型填充](#title)
- [问题描述](#description)
- [技术来源的基因型缺失](#genotype-missing-drived-from-tech)
- [缺失的判断：缺失率](#missing-rate)
- [基因型缺失的影响](#effect)
- [基因型填充的原理](#principle-of-imputation)
- [实现工具](#tools)




<h1 name="title">基因型填充</h1>

<a name="description"><h2>问题描述 [<sup>目录</sup>](#content)</h2></a>

基因型缺失：样本中没有被测序数据覆盖到的区域，基因型就属于未知的，我们将之称为缺失位点

<p align="center"><img src=./picture/Genotype-Imputation-description.png width=800 /></p>

基因型数据的缺失又分为**遗传性缺失**和**检测性缺失**：

> - 遗传性缺失：个体遗传信息的变异（例如，这个位点DNA片段真实缺失）导致的基因型缺失
> 
> - 检测性缺失：由于检测技术的局限、错误等导致的信息丢失。各类基因型检测技术都会产生检测性的基因型缺失。

<a name="genotype-missing-drived-from-tech"><h2>技术来源的基因型缺失 [<sup>目录</sup>](#content)</h2></a>

1. 全基因组重测序技术

	全基因组重测序理论上应该覆盖整个基因组，因此**未覆盖的区域**都可以被定义为缺失。那么群体研究中的低深度测序（一般平均深度低于10X），不可避免会产生大量随机缺失。

2. 简化基因组测序

	简化基因组测序是通过酶切，并富集限制性内切酶周边的片段并进行测序的策略。针对简化基因组，我们称的缺失一般指的是没有被检测到的酶切片段相关的位点。简化基因组的缺失，主要与**酶切效率**有关。酶切效率越高，缺失率越低。

3. 外显子测序以及目标区域捕获测序

	同简化基因组测序类似，基于探针杂交的DNA捕获以及测序技术，同样会产生大量的缺失。这种缺失主要是由于**探针杂交捕获的效率**所致。

4. SNP芯片

	SNP芯片利用芯片杂交后的荧光信号，来判断某个位点的基因型。SNP芯片同样也会产生大量缺失。但在实际的研究中，SNP 芯片主要面临的问题是**芯片型号不同**，甚至来源不同的厂商，那么芯片中包含的SNP位点也不同。当来源不同的数据一起分析的时候，将面临数据不一致的问题。简单说来，就是你有的我没有，我有的你没有。如下图，Affymetrix和illuminate两大SNP 芯片厂商生产的人类芯片就使用的是不同的SNP集，当放在一起分析的时候将面临SNP不一致的问题。

	<p align="center"><img src=./picture/Genotype-Imputation-missing-resource-snpArray.jpg width=800 /></p>

注意！

>** 基因型缺失是一个相对性的概念**。以上缺失的概念都是针对同种技术的比较。不同的技术比较，也可以定义为缺失。例如，同样一份样本，我们使用全部以上4种技术检测。如果以全基因组高深度测序（>30X）为参照标准，后续的3种技术都有大量位点没有检测到，处于基因型缺失的状态。

<a name="missing-rate"><h2>缺失的判断：缺失率 [<sup>目录</sup>](#content)</h2></a>

分为**样本水平的缺失率**和**位点水平的缺失率**

例如下图，0、1、2 分别代表三种检测到的基因型，图中缺失位点使用“？”表示。那么样本1的缺失率=20%（总体10个位点，有两个位点缺失），而位点2的缺失率=60%（总体5个位点，有3个位点缺失）

<p align="center"><img src=./picture/Genotype-Imputation-missing-rate.png width=800 /></p>

<a name="effect"><h2>基因型缺失的影响 [<sup>目录</sup>](#content)</h2></a>

基因型缺失最直接的影响就是这个位置的**信息缺失**，从而影响下游分析（包括遗传图谱构建，QTL定位，选择压力分析，GWAS分析等）的信息完整性和准确性。


例如，（b）中红色的点是（a）中缺失的位点。而与性状关联的SNP位点，恰恰位于虚线所在的区域内。这些显著位点在（a）中是缺失的，所以（a）没有检测到关联信号，从丢失了非常关键的信息

<p align="center"><img src=./picture/Genotype-Imputation-missing-effect.jpg width=500 /></p>

基因型缺失对GWAS分析、选择压力分析影响都比较大

<a name="principle-of-imputation"><h2>基因型填充的原理 [<sup>目录</sup>](#content)</h2></a>

原理：

> 基于**家系样本的遗传特性**。具有已知亲缘关系的个体之间具有共享的单体型（haplotype），这些由有限个遗传标记所构成的单体型随祖先一起遗传，反映连锁不平衡。
> 
> 在具有相同单体型的家系中，**遗传标记少的样本可以参照遗传标记多的样本进行基因型填充**。对于没有亲缘关系的样本，以上理论也基本适用，主要的差别在于**无血缘关系的样本之间共享的单体型比家系样本之间的要短很多**。对无亲缘关系样本进行基因型填充需要一个高密度遗传标记构成的单体型图谱作为参照。
> 
> 通过对比待填充样本和参考模板，找到两者之间共有的单体型，然后就可以将匹配上的参考模板中的位点复制到目标数据集中。

常见imputation的基本逻辑包括两步：

> - 从目标位点/区域非缺失的位点中，总结这个区域的基因型规律，并分类。其实就是分析各个区域的单体型组成；
> 
> - 根据某样本缺失位点的上下其他非缺失位点，判断这个区域属于哪种单倍型。然后根据所属单倍型的基因型补充该样本的缺失位点；

<p align="center"><img src=./picture/Genotype-Imputation-example.jpg width=800 /></p>

根据缺失样本有限的基因型信息（仅有3个位点），就可以判断这个样本与参考单倍型集中的哪种单倍型最为相似（图中分别对应紫色、绿色、黄色三种单倍型）。然后，将对应的最相似的单倍型赋予给该样本，从而让该样本获得完整的基因型，图b

<a name="tools"><h2>实现工具 [<sup>目录</sup>](#content)</h2></a>

(1) **计算密集型**，比如IMPUTE、 IMPUTE2、MACH、 和fastPHASE/BIMBAM

这种类型的方法在填充的过程中**充分考虑到全部可以观察到的基因型信息**，使得对缺失值的估算更加精确；但以上大部分软件都是针对人类的开发的。人类种群的遗传特性是个体杂合率较高、近交率低、系谱关系来源随机。很多植物，尤其作物的遗传特性则和人类相反。

(2) **计算高效型**，比如PLINK、TUNA、WHAP和BEAGLE

此种算法**仅仅关注与特定位点相邻的一小部分标记**的基因型，因此在计算上更加快捷





---

参考资料：

(1) [【简书】群体遗传学习笔记-基因型缺失数据的填充](https://www.jianshu.com/p/dafd1e6e4a98)
